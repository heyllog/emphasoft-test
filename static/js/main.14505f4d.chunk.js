(this.webpackJsonpemphasoft=this.webpackJsonpemphasoft||[]).push([[0],{161:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(62),l=a.n(c),s=(a(71),a(5)),u=a(15),o=a(1),m=a(11),i=a.n(m),b=a(26),p=/^[\w.@+-]{1,150}$/,E=/^(?=.*[A-Z])(?=.*\d).{8,128}$/;var f=function(e){var t=e.setToken,a=Object(n.useState)(""),c=Object(s.a)(a,2),l=c[0],u=c[1],m=Object(n.useState)(""),f=Object(s.a)(m,2),d=f[0],h=f[1],v=Object(n.useState)(""),k=Object(s.a)(v,2),j=k[0],O=k[1],g=Object(n.useState)(!1),S=Object(s.a)(g,2),w=S[0],N=S[1],x=Object(o.f)(),y=new AbortController,C=function(){var e=Object(b.a)(i.a.mark((function e(a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),N(!0),p.test(l)&&E.test(d)){e.next=6;break}return O("Incorrect username or password."),N(!1),e.abrupt("return");case 6:return e.prev=6,e.next=9,fetch("https://emphasoft-test-assignment.herokuapp.com/api-token-auth/",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},signal:y.signal,body:JSON.stringify({username:l,password:d})});case 9:if(!(n=e.sent).ok){e.next=16;break}return e.next=13,n.json();case 13:r=e.sent,t(r.token),x.push("users");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),y.signal.aborted||(O("Incorrect username or password."),N(!1));case 21:case"end":return e.stop()}}),e,null,[[6,18]])})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){return function(){y.abort()}}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"auth-form",onSubmit:C},r.a.createElement("span",{className:"login"},"Account Login"),j&&r.a.createElement("span",{className:"error"},j),r.a.createElement("label",null,"Username",r.a.createElement("input",{value:l,type:"text",placeholder:"Username",onChange:function(e){return u(e.target.value)}})),r.a.createElement("br",null),r.a.createElement("label",null,"Password",r.a.createElement("input",{value:d,type:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)}})),r.a.createElement("br",null),r.a.createElement("button",{className:"button",type:"submit"},w?"Loading...":"Login")))};var d=function(e){var t=e.message,a=e.link,n=e.button;return r.a.createElement("div",{className:"authorized"},r.a.createElement("p",null,t),r.a.createElement(u.b,{to:a},r.a.createElement("button",{className:"button"},n)))};var h=function(e){var t=e.token,a=e.setToken;return r.a.createElement("div",{className:"auth"},t?r.a.createElement(d,{message:"You are already authorized",link:"users",button:"Users List"}):r.a.createElement(f,{setToken:a}))},v=a(65),k=a(64),j=a.n(k),O=a(39),g=a.n(O);var S=function(e){var t=e.setSearchTerm;return r.a.createElement("div",{className:"search"},r.a.createElement("label",null,r.a.createElement("span",null,"Find by username: "),r.a.createElement("input",{type:"text",onChange:function(e){t(e.target.value)}})))};var w=function(e){var t=e.users,a=e.onSort;return r.a.createElement("div",{className:"users-table"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{onClick:function(){return a("id")}},"ID"),r.a.createElement("th",null,"Username"),r.a.createElement("th",null,"First Name"),r.a.createElement("th",null,"Last Name"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.username),r.a.createElement("td",null,e.first_name),r.a.createElement("td",null,e.last_name))})))))};var N=function(){return r.a.createElement("div",{className:"lds-facebook"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))};var x=function(e){var t=e.token,a=Object(n.useState)([]),c=Object(s.a)(a,2),l=c[0],u=c[1],o=Object(n.useState)("asc"),m=Object(s.a)(o,2),p=m[0],E=m[1],f=Object(n.useState)(""),h=Object(s.a)(f,2),k=h[0],O=h[1],x=Object(n.useState)(null),y=Object(s.a)(x,2),C=y[0],T=y[1],L=Object(n.useCallback)((function(e){E("asc"===p?"desc":"asc"),u(j()(Object(v.a)(l),e,p))}),[p,l]),A=Object(n.useCallback)((function(e){return e?l.filter((function(t){return t.username.toLowerCase().includes(e.toLowerCase())})):null}),[l]);return Object(n.useEffect)((function(){T(A(k))}),[A,k]),Object(n.useEffect)((function(){var e=new AbortController;return t&&function(){var t=Object(b.a)(i.a.mark((function t(a){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://emphasoft-test-assignment.herokuapp.com/api/v1/users/",{signal:e.signal,headers:{Authorization:"Token ".concat(a)}});case 3:if(!(n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:r=t.sent,u(r);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()(t),function(){e.abort()}}),[t]),t?r.a.createElement("div",{className:"users-page"},r.a.createElement(S,{setSearchTerm:O}),g()(l)?r.a.createElement(N,null):g()(C)&&C?r.a.createElement("span",{className:"error"},"No such users"):r.a.createElement(w,{users:C||l,onSort:L})):r.a.createElement(d,{message:"You are not authorized",link:"/",button:"Sign In"})};var y=function(){return r.a.createElement("p",{className:"not-found"},"UH OH! You're lost.")};var C=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],c=t[1];return r.a.createElement(u.a,null,r.a.createElement(o.c,null,r.a.createElement(o.a,{exact:!0,path:"/"},r.a.createElement(h,{token:a,setToken:c})),r.a.createElement(o.a,{path:"/users"},r.a.createElement(x,{token:a})),r.a.createElement(o.a,{path:"*"},r.a.createElement(y,null))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(C,null)),document.getElementById("root"))},66:function(e,t,a){e.exports=a(161)},71:function(e,t,a){}},[[66,1,2]]]);
//# sourceMappingURL=main.14505f4d.chunk.js.map